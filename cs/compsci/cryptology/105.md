# Дифи-Хелман протокол за размену кључа

**Проблем размене кључа у симетричном шифарском систему**

- Класичан проблем: Алиса и Боб желе да имају сигурну комуникацију, зна се да Ева прислушкује
- Алиса и Боб могу повремено да се лично састају и размењују кључеве
	- Ово решење често није могуће (нпр. достава кључа подморницама на 1000 километара од базе?)

**Основна идеја**

1. Алиса ставља поруку у металну кутију, закључава је катанцем A и шаље је Бобу
2. Након пријема, Боб ставља свој катанац B и враћа пошиљку (са два катанца) Алиси
3. Алиса скида свој катанац A и враћа пошиљку (на којој је још увек катанац B) Бобу
4. Боб сада може да отвори пошиљку (нападач не може ни у једном тренутку!)

**Дифи-Хелман алгоритам за размену кључа**

- енгл. *Diffie–Hellman key exchange*
- Витфилд Дифи (енгл. *Whitfield Diffie*) и Мартин Хелман (енгл. *Martin Hellman*)
- Представља алгоритам за размену кључа
- Користи се за размену заједничког симетричног кључа
- Није намењен за шифровање или дигитално потписивање!
- Користи једносмерне функције са замком (енгл. *One-way trapdoor function*)
	- Лако се израчунавају у једном смеру, тешко у другом
	- За дато x лако је израчунати f(x), тешко је израчунати x из f(x)
	- Ако је позната тајна вредност (замка), x се лако рачуна

**Дифи-Хелман алгоритам - математичке основе**

- Генерисани су параметри p и q који се размењују јавним каналом
	- p је велики прост број
	- q је примитивни корен по модулу p (модуларна аритметика)
- Алиса бира тајну вредност a (велики случајан цео број)
- Боб бира тајну вредност b (велики случајан цео број)
1. Алиса шаље јавно вредност A = g<sup>a</sup> (mod p) Бобу
2. Боб шаље јавно вредност B = g<sup>b</sup> (mod p) Алиси
3. Обоје рачунају заједничку тајну вредност K (сесијски кључ):
	- Ka = B<sup>a</sup> (mod p) = (g<sup>b</sup>)<sup>a</sup> (mod p) = g<sup>ab</sup> (mod p)
	- Kb = A<sup>b</sup> (mod p) = (g<sup>a</sup>)<sup>b</sup> (mod p) = g<sup>ab</sup> (mod p)
	- Ka = Kb = K

**Пример**

- Јавни параметри:
	- p = 11
	- g = 7
- Тајни параметри:
	- a = 3
	- b = 6
- Алиса шаље Бобу:
	- A = 7<sup>3</sup> (mod 11) = 343 (mod 11) = 2
- Боб шаље Алиси:
	- B = 7<sup>6</sup> (mod 11) = 117649 (mod 11) = 4
- Алиса узима Бобов резултат и рачуна:
	- Ka = B<sup>a</sup> (mod p) = 4<sup>3</sup> (mod 11) = 64 (mod 11) = 9
- Боб узима Алисин резултат и рачуна:
	- Kb = A<sup>b</sup> (mod p) = 2<sup>6</sup> (mod 11) = 64 (mod 11) = 9
- Ka = Kb = 9
- У пракси се користе већи бројеви (за p преко 1024 бита!)

**Дифи-Хелман алгоритам - слабости**

- Осетљив на напад типа човек у средини (енгл. *Man-in-the-middle, MITM*)
- Потребан је механизам аутентификације (решење: асиметрична криптографија)

**Напомена:** већина материјала преузета са курса "Криптологија 1" на [Универзитету Сингидунум](https://singidunum.ac.rs).
